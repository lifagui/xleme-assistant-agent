# ============================================================================
# Assistant Agent - Full Example Configuration
# ============================================================================
# This configuration demonstrates all available options with customizations.
# ============================================================================

spring:
  application:
    name: anxun-assistant-agent

  # ==========================================================================
  # PostgreSQL Database Configuration
  # ==========================================================================
  datasource:
    url: jdbc:postgresql://${DB_HOST:localhost}:${DB_PORT:5432}/${DB_NAME:assistant}
    username: ${DB_USERNAME:postgres}
    password: ${DB_PASSWORD:postgres}
    driver-class-name: org.postgresql.Driver
    hikari:
      minimum-idle: 5
      maximum-pool-size: 20
      idle-timeout: 300000
      connection-timeout: 20000
      max-lifetime: 1200000

  # ==========================================================================
  # JPA / Hibernate Configuration
  # ==========================================================================
  jpa:
    hibernate:
      ddl-auto: validate  # 生产环境使用 validate，由 SQL 脚本管理表结构
    show-sql: false
    open-in-view: false
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        jdbc:
          batch_size: 50
        order_inserts: true
        order_updates: true

server:
  port: 8080
  address: 0.0.0.0

# ============================================================================
# DashScope Configuration
# ============================================================================
spring.ai.dashscope:
  api-key: ${DASHSCOPE_API_KEY}
  chat:
    options:
      model: qwen-max

# ============================================================================
# Experience Module - with FastIntent enabled
# ============================================================================
spring.ai.alibaba.codeact.extension.experience:
  enabled: false
  fast-intent-enabled: true
  fast-intent-react-enabled: true
  fast-intent-code-enabled: true
  fast-intent-allowed-tools:
    - send_success_message
    - send_error_message
    - send_notification
    - write_code
    - write_condition_code
  logging:
    enabled: true

# ============================================================================
# Learning Module - with after-agent learning
# ============================================================================
spring.ai.alibaba.codeact.extension.learning:
  enabled: false
  online:
    enabled: true
    after-agent:
      enabled: true
      learning-types:
        - experience

# ============================================================================
# Search Module
# Default: enabled with project and knowledge search
# ============================================================================
spring.ai.alibaba.codeact.extension.search:
  enabled: false
  project-search-enabled: true
  knowledge-search-enabled: true
  web-search-enabled: false           # Requires API key
  default-top-k: 10
  search-timeout-ms: 5000

# ============================================================================
# Reply Module - with custom tools
# ============================================================================
spring.ai.alibaba.codeact.extension.reply:
  enabled: false
  tools:
    - toolName: send_success_message
      channelCode: IDE_TEXT
      description: Send a success message to the IDE console
      reactEnabled: true
      codeActEnabled: true
      parameters:
        - name: text
          type: STRING
          required: true
          description: The success message text
    - toolName: send_error_message
      channelCode: IDE_TEXT
      description: Send an error message to the IDE console
      reactEnabled: true
      codeActEnabled: true
      parameters:
        - name: text
          type: STRING
          required: true
          description: The error message text
    - toolName: send_notification
      channelCode: IDE_TEXT
      description: Send a notification message
      reactEnabled: true
      codeActEnabled: true
      parameters:
        - name: text
          type: STRING
          required: true
          description: The notification text

# ============================================================================
# Evaluation Module - with input routing
# ============================================================================
spring.ai.alibaba.codeact.extension.evaluation:
  enabled: false
  input-routing:
    enabled: true
    suite-id: input_routing_suite
  code-generation-input:
    enabled: true
    suite-id: code_generation_input_suite

# ============================================================================
# Assistant Agent Reminder - Internal API Configuration
# ============================================================================
assistant:
  reminder:
    enabled: true
    internal-api:
      base-url: ${INTERNAL_API_BASE_URL:http://localhost:8088}
      user-check-path: /internal/user/check
      sms-send-path: /internal/sms/send
      token: ${INTERNAL_API_TOKEN:internal_secret_token_123}
  persistence:
    async:
      core-pool-size: 2
      max-pool-size: 10
      queue-capacity: 1000

# ============================================================================
# Logging - Debug level for development
# ============================================================================
logging:
  level:
    com.alibaba.assistant.agent: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE